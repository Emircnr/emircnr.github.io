<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Global Conquest — Offline (AI Bot)</title>

  <!-- Not: Harici font/CDN kullanılmadı. CSP katı ortamlar için güvenli. -->
  <style>
    :root{
      --bg-0:#0b0e13;
      --bg-1:#10151d;
      --bg-2:#0f1826;
      --glass:rgba(255,255,255,.06);
      --glass-2:rgba(255,255,255,.10);
      --txt:#e9eef5;
      --muted:#a9b3c4;
      --acc:#3cf3c4;
      --acc-2:#69a5ff;
      --warn:#ffb757;
      --danger:#ff5d6c;
      --ok:#37d67a;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:var(--txt);
      background:
        radial-gradient(1200px 800px at 20% -10%, #18223a 0%, transparent 60%),
        radial-gradient(1000px 600px at 100% 0%, #1b2a4a 0%, transparent 60%),
        linear-gradient(160deg, var(--bg-0), var(--bg-1) 60%, #0a0f17);
      overflow:hidden;
    }

    /* ---------- Utilities ---------- */
    .hidden{display:none !important}
    .btn{
      border:0; cursor:pointer; color:#061016; font-weight:700;
      padding:.9rem 1rem; border-radius:12px;
      background:linear-gradient(135deg,var(--acc),var(--acc-2));
      box-shadow:var(--shadow);
      transition:transform .15s ease, filter .15s ease, opacity .2s ease;
      user-select:none;
    }
    .btn:hover{transform:translateY(-1px)}
    .btn:active{transform:translateY(0)}
    .btn--ghost{
      background:transparent; color:var(--txt); border:1px solid var(--glass-2);
      backdrop-filter: blur(6px);
    }
    .btn--danger{ background:linear-gradient(135deg,var(--danger),#ff7a86); color:#fff }
    .btn--ok{ background:linear-gradient(135deg,var(--ok),#9bffc3); color:#061016 }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(10px);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    .title{
      font-weight:900; letter-spacing:.5px; text-transform:uppercase;
    }

    /* ---------- Start Screen ---------- */
    #start-screen{
      position:fixed; inset:0; display:grid; place-items:center; padding:24px;
    }
    .hero{
      width:min(1080px, 100%); display:grid; grid-template-columns: 1.15fr .85fr;
      gap:24px;
    }
    @media (max-width: 980px){
      .hero{ grid-template-columns: 1fr; max-width:720px }
    }

    .hero-promo{
      position:relative; overflow:hidden; padding:28px;
      min-height: 380px;
    }
    .hero-promo .glow{
      position:absolute; inset:-40% -20% auto auto; width:70%; height:140%;
      background:radial-gradient(closest-side, rgba(60,243,196,.15), transparent 70%);
      filter: blur(30px); pointer-events:none;
    }
    .hero-promo h1{
      margin:0 0 12px; font-size:clamp(26px, 4.2vw, 44px);
      background:linear-gradient(135deg,#cfe9ff,#fff);
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    .hero-promo p{ color:var(--muted); line-height:1.6 }

    .setup{
      padding:22px; display:flex; flex-direction:column; gap:16px;
    }
    .row{ display:grid; grid-template-columns: 1fr 1fr; gap:12px }
    .row-3{ display:grid; grid-template-columns: 1fr 1fr 1fr; gap:12px }
    .field{ display:flex; flex-direction:column; gap:8px }
    label{ font-size:.9rem; color:#cbd6ea }
    input[type="number"], input[type="text"], input[type="color"], select, input[type="range"]{
      width:100%; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.14);
      color:var(--txt); padding:.65rem .75rem; border-radius:10px; outline:none;
    }
    input[type="range"]{ padding:0; height:36px }
    .hint{ font-size:.8rem; color:#9db3cc }

    .start-actions{ display:flex; gap:12px; margin-top:6px }

    /* ---------- Game Screen ---------- */
    #game{
      position:fixed; inset:0; display:grid; grid-template-rows: auto 1fr auto; opacity:0; pointer-events:none;
      transition: opacity .3s ease;
    }
    #game.ready{ opacity:1; pointer-events:auto }

    /* Topbar */
    #topbar{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:10px 14px; margin:10px; border-radius:12px;
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12); backdrop-filter: blur(10px);
      box-shadow:var(--shadow);
    }
    #brand{ display:flex; gap:10px; align-items:center }
    #brand .dot{ width:10px; height:10px; border-radius:50%; background:var(--acc) }
    #hud{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      color:#cfe1ff; font-weight:700;
    }
    .chip{
      padding:.45rem .65rem; border-radius:10px;
      background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12);
    }
    #turn-timer{ color:var(--warn) }

    /* Map Layer */
    #map-wrap{ position:relative; margin:8px; border-radius:14px; overflow:hidden; }
    #mapCanvas{ width:100%; height:100%; display:block; background:radial-gradient(1200px 600px at 50% 0%, #0f2338 0%, #0b121d 60%); }

    /* Dock */
    #dock{
      display:flex; gap:10px; align-items:center; justify-content:center;
      padding:10px; margin:8px; border-radius:12px;
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12); backdrop-filter: blur(10px);
      box-shadow:var(--shadow);
      flex-wrap:wrap;
    }
    .dock-btn{
      display:flex; align-items:center; gap:8px; padding:.7rem .9rem; border-radius:12px;
      background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); color:var(--txt);
      cursor:pointer; user-select:none;
    }
    .dock-btn:hover{ background:rgba(255,255,255,.12) }
    .ico{ font-size:1.1rem }

    /* Panels / Modals */
    .modal{
      position:fixed; inset:0; display:none; align-items:flex-end; justify-content:center; padding:18px;
      background: rgba(6,12,18,.55);
    }
    .modal.open{ display:flex }
    .sheet{
      width:min(560px, 96vw); max-height:80vh; overflow:auto; padding:18px; border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,.1), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.14); box-shadow:var(--shadow);
    }
    .sheet header{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:8px }
    .sheet h3{ margin:0 }
    .section{ padding:10px 0; border-top:1px solid rgba(255,255,255,.08) }
    .row-items{ display:grid; grid-template-columns: 1fr 1fr; gap:10px }
    .list{ display:flex; flex-direction:column; gap:8px }

    /* Players side panel */
    #players-panel{
      position:fixed; left:12px; bottom:92px; width:320px; max-height:70vh; overflow:auto; padding:12px;
      border-radius:14px; background:linear-gradient(180deg, rgba(255,255,255,.1), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12); box-shadow:var(--shadow); display:none;
    }
    #players-panel.open{ display:block }
    .player-card{
      background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
      padding:10px; border-radius:12px; display:grid; grid-template-columns:auto 1fr; gap:8px;
    }
    .avatar{ width:28px; height:28px; border-radius:50%; background:linear-gradient(135deg,#8cffd8,#6aa7ff) }

    /* Toasts */
    #toasts{ position:fixed; right:14px; top:14px; display:flex; flex-direction:column; gap:10px; z-index:30 }
    .toast{
      background:linear-gradient(180deg, rgba(255,255,255,.1), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.14); border-radius:12px; padding:.75rem .9rem; min-width:240px;
      box-shadow:var(--shadow)
    }

    /* Tooltip (country/hex info) */
    #tooltip{
      position:fixed; pointer-events:none; transform:translate(-50%, calc(-100% - 12px));
      background:rgba(20,30,45,.95); border:1px solid rgba(255,255,255,.14); padding:.5rem .6rem; border-radius:8px;
      font-size:.85rem; color:#d7e6ff; display:none; z-index:20;
    }

    /* Small helpers */
    .spacer{ flex:1 }
    .right{ text-align:right }
  </style>
</head>
<body>

  <!-- ========== START SCREEN (Bot seç, harita, zorluk) ========== -->
  <main id="start-screen">
    <div class="hero">
      <section class="hero-promo card" aria-label="Tanıtım">
        <div class="glow"></div>
        <h1 class="title">GLOBAL CONQUEST</h1>
        <p>
          Tek oyunculu, sıra tabanlı bir dünya hâkimiyeti oyunu.
          İstediğin sayıda <strong>AI Bot</strong> ekle, harita boyutunu ve zorluk seviyesini seç,
          modern bir taktik haritası üzerinde mücadeleye başla. Komşuluk kuralları,
          binalar, paktlar, piyasa ve daha fazlası bu sürümde.
        </p>
        <div style="margin-top:16px" class="hint">
          İpucu: “Gelişmiş seçenekler” ile tur süresi ve tohum (seed) de belirleyebilirsin.
        </div>
      </section>

      <section class="setup card" aria-label="Oyun Ayarları">
        <h2 class="title" style="margin:0 0 6px">OYUN AYARLARI</h2>

        <div class="row">
          <div class="field">
            <label for="bot-count">Bot Sayısı</label>
            <input id="bot-count" type="number" min="1" max="7" value="3" inputmode="numeric" />
            <div class="hint">1–7 arası önerilir.</div>
          </div>

          <div class="field">
            <label for="difficulty">Zorluk</label>
            <select id="difficulty">
              <option value="easy">Kolay</option>
              <option value="normal" selected>Normal</option>
              <option value="hard">Zor</option>
              <option value="insane">Delice</option>
            </select>
            <div class="hint">AI agresifliği ve ekonomisi etkilenir.</div>
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label for="map-size">Harita Boyutu</label>
            <select id="map-size">
              <option value="small">Küçük (60 bölge)</option>
              <option value="medium" selected>Orta (96 bölge)</option>
              <option value="large">Büyük (140 bölge)</option>
            </select>
          </div>

          <div class="field">
            <label for="player-color">Renk (Bayrak/Ülkeler)</label>
            <input id="player-color" type="color" value="#3cf3c4" />
          </div>
        </div>

        <details>
          <summary class="hint">Gelişmiş seçenekler</summary>
          <div class="row">
            <div class="field">
              <label for="turn-seconds">Tur Süresi (saniye)</label>
              <select id="turn-seconds">
                <option value="30">30</option>
                <option value="45">45</option>
                <option value="60" selected>60</option>
                <option value="90">90</option>
              </select>
            </div>
            <div class="field">
              <label for="seed">Harita Tohumu (opsiyonel)</label>
              <input id="seed" type="text" placeholder="örn. 2025-hex" maxlength="40" />
              <div class="hint">Aynı tohum aynı haritayı üretir.</div>
            </div>
          </div>
        </details>

        <div class="start-actions">
          <button id="btn-start" class="btn" aria-label="Oyunu Başlat">Başlat</button>
          <button id="btn-howto" class="btn btn--ghost" aria-label="Nasıl Oynanır">Nasıl oynanır?</button>
        </div>
      </section>
    </div>
  </main>

  <!-- ========== GAME LAYER ========== -->
  <section id="game" aria-label="Oyun">
    <!-- Top Bar -->
    <header id="topbar" class="card" role="navigation" aria-label="Üst menü">
      <div id="brand">
        <span class="dot" aria-hidden="true"></span>
        <strong>Global Conquest</strong>
      </div>

      <div id="hud" aria-live="polite">
        <span class="chip">Tur: <span id="hud-round">1</span></span>
        <span class="chip">Sıra: <span id="hud-current">—</span></span>
        <span class="chip">Bot: <span id="hud-bots">0</span></span>
        <span class="chip">⛽ <span id="hud-oil">0</span></span>
        <span class="chip">🌾 <span id="hud-wheat">0</span></span>
        <span class="chip">💵 <span id="hud-money">0</span></span>
        <span class="chip" id="turn-timer">60s</span>
      </div>

      <div style="display:flex; gap:8px">
        <button id="btn-players" class="btn btn--ghost" aria-expanded="false">Oyuncular</button>
        <button id="btn-end" class="btn btn--ok">Turu Bitir</button>
        <button id="btn-settings" class="btn btn--ghost" aria-label="Ayarlar">⚙️</button>
      </div>
    </header>

    <!-- Map -->
    <div id="map-wrap">
      <canvas id="mapCanvas" aria-label="Taktik Harita" tabindex="0"></canvas>
    </div>

    <!-- Dock -->
    <nav id="dock" aria-label="Alt eylem çubuğu" class="card">
      <button class="dock-btn" id="btn-attack" title="Saldırı (⚔️)"><span class="ico">⚔️</span> Saldırı</button>
      <button class="dock-btn" id="btn-build" title="Bina Kur (🏗️)"><span class="ico">🏗️</span> Bina</button>
      <button class="dock-btn" id="btn-market" title="Piyasa (🛒)"><span class="ico">🛒</span> Piyasa</button>
      <button class="dock-btn" id="btn-diplomacy" title="Paktlar (🤝)"><span class="ico">🤝</span> Pakt</button>
      <button class="dock-btn" id="btn-army" title="Ordu (🪖)"><span class="ico">🪖</span> Ordu</button>
      <div class="spacer"></div>
      <button class="dock-btn" id="btn-log" title="Günlük (📜)"><span class="ico">📜</span> Günlük</button>
    </nav>
  </section>

  <!-- ========== SIDE PANEL: Players ========== -->
  <aside id="players-panel" aria-label="Oyuncu Bilgileri" class="card">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px">
      <strong>Oyuncular</strong>
      <button id="btn-close-players" class="btn btn--ghost">Kapat</button>
    </div>
    <div id="players-list" class="list" aria-live="polite"></div>
  </aside>

  <!-- ========== MODALS ========== -->

  <!-- Attack -->
  <div id="modal-attack" class="modal" role="dialog" aria-modal="true" aria-labelledby="attackTitle">
    <div class="sheet">
      <header>
        <h3 id="attackTitle">Saldırı</h3>
        <button class="btn btn--ghost" data-close="modal-attack">Kapat</button>
      </header>
      <div class="section">
        <div class="field">
          <label>Hedef Bölge</label>
          <div id="attack-target" class="chip">— haritadan seç —</div>
          <div class="hint">Sadece komşu bölgelere saldırabilirsiniz.</div>
        </div>
      </div>
      <div class="section row">
        <div class="field">
          <label for="attack-units">Gönderilecek Asker</label>
          <input id="attack-units" type="number" min="1" value="1" />
          <div class="hint">1 asker = 1 varil petrol</div>
        </div>
        <div class="field">
          <label for="attack-plan">Plan</label>
          <select id="attack-plan">
            <option value="normal" selected>Normal</option>
            <option value="blitz">Blitz (+%15 başarı, +%20 petrol)</option>
            <option value="cautious">Temkinli (-%15 kayıp)</option>
          </select>
        </div>
      </div>
      <div class="section right">
        <button id="do-attack" class="btn btn--danger">Saldır</button>
      </div>
    </div>
  </div>

  <!-- Build -->
  <div id="modal-build" class="modal" role="dialog" aria-modal="true" aria-labelledby="buildTitle">
    <div class="sheet">
      <header>
        <h3 id="buildTitle">Bina Kur</h3>
        <button class="btn btn--ghost" data-close="modal-build">Kapat</button>
      </header>

      <div class="section">
        <div class="hint">Haritadan kendi bölgeni seç ve aşağıdan bina ekle.</div>
        <div id="build-selected" class="chip">Seçili Bölge: —</div>
      </div>

      <div class="section row-items">
        <div class="field">
          <label for="barracks-q">Kışla (300$ + 50⛽ + 120🌾)</label>
          <input id="barracks-q" type="number" min="1" value="1" />
          <button id="btn-build-barracks" class="btn" style="margin-top:8px">Kur</button>
        </div>
        <div class="field">
          <label for="factory-q">Fabrika (500$ + 130⛽)</label>
          <input id="factory-q" type="number" min="1" value="1" />
          <button id="btn-build-factory" class="btn" style="margin-top:8px">Kur</button>
        </div>
        <div class="field">
          <label for="refinery-q">Rafineri (800$ + 250⛽)</label>
          <input id="refinery-q" type="number" min="1" value="1" />
          <button id="btn-build-refinery" class="btn" style="margin-top:8px">Kur</button>
        </div>
        <div class="field">
          <label for="mill-q">Değirmen (200$ + 100⛽)</label>
          <input id="mill-q" type="number" min="1" value="1" />
          <button id="btn-build-mill" class="btn" style="margin-top:8px">Kur</button>
        </div>
        <div class="field">
          <label>Kale (1000$ + 1000⛽ + 1000🌾)</label>
          <button id="btn-build-castle" class="btn" style="margin-top:8px">Kale Kur</button>
          <div class="hint">Saldıran askerlerin %5’i ölür. Tek kale.</div>
        </div>
        <div class="field">
          <label>Kale Güçlendirme</label>
          <div id="castle-upgrade-cost" class="chip">Sonraki maliyet: —</div>
          <button id="btn-upgrade-castle" class="btn" style="margin-top:8px">Güçlendir</button>
          <div class="hint">Her seviye +%5, en fazla %30.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Market -->
  <div id="modal-market" class="modal" role="dialog" aria-modal="true" aria-labelledby="marketTitle">
    <div class="sheet">
      <header>
        <h3 id="marketTitle">Piyasa</h3>
        <button class="btn btn--ghost" data-close="modal-market">Kapat</button>
      </header>

      <div class="section row">
        <div class="field">
          <label for="market-item">İşlem</label>
          <select id="market-item">
            <option value="oil">Petrol</option>
            <option value="wheat">Buğday</option>
          </select>
        </div>
        <div class="field">
          <label for="market-amount">Miktar</label>
          <input id="market-amount" type="number" min="1" value="50" />
        </div>
        <div class="field">
          <label for="market-side">Yön</label>
          <select id="market-side">
            <option value="buy">Al</option>
            <option value="sell">Sat</option>
          </select>
        </div>
        <div class="field">
          <label for="market-price">Limit Fiyat ($)</label>
          <input id="market-price" type="number" min="1" value="10" />
        </div>
      </div>

      <div class="section right">
        <button id="btn-market-place" class="btn">Emir Ver</button>
      </div>

      <div class="section">
        <h4 style="margin:0 0 8px">Aktif Emirler</h4>
        <div id="orders-list" class="list"></div>
      </div>
    </div>
  </div>

  <!-- Diplomacy -->
  <div id="modal-diplomacy" class="modal" role="dialog" aria-modal="true" aria-labelledby="dipTitle">
    <div class="sheet">
      <header>
        <h3 id="dipTitle">Paktlar</h3>
        <button class="btn btn--ghost" data-close="modal-diplomacy">Kapat</button>
      </header>

      <div class="section row">
        <div class="field">
          <label for="dip-target">Bot Seç</label>
          <select id="dip-target"></select>
        </div>
        <div class="field">
          <label for="dip-duration">Tur</label>
          <input id="dip-duration" type="number" min="1" value="3" />
        </div>
        <div class="field">
          <label for="dip-cost">Tek Seferlik Ödeme ($)</label>
          <input id="dip-cost" type="number" min="0" value="100" />
        </div>
      </div>

      <div class="section right">
        <button id="btn-send-pact" class="btn">Teklif Gönder</button>
      </div>

      <div class="section">
        <h4 style="margin:0 0 8px">Aktif Paktlar</h4>
        <div id="pacts-list" class="list"></div>
      </div>
    </div>
  </div>

  <!-- Army -->
  <div id="modal-army" class="modal" role="dialog" aria-modal="true" aria-labelledby="armyTitle">
    <div class="sheet">
      <header>
        <h3 id="armyTitle">Ordu</h3>
        <button class="btn btn--ghost" data-close="modal-army">Kapat</button>
      </header>

      <div class="section row">
        <div class="field">
          <label for="buy-soldiers">Asker Satın Al (10$ + 25🌾)</label>
          <input id="buy-soldiers" type="number" min="1" value="10" />
          <button id="btn-buy-soldiers" class="btn" style="margin-top:8px">Satın Al</button>
        </div>
        <div class="field">
          <label for="pull-from">Bölgeden Asker Çek</label>
          <input id="pull-count" type="number" min="1" value="5" />
          <button id="btn-pull" class="btn" style="margin-top:8px">Çek</button>
          <div class="hint">Önce haritadan bölge seç.</div>
        </div>
      </div>

      <div class="section">
        <h4 style="margin:0 0 8px">Asker Dağılımı</h4>
        <div id="army-list" class="list"></div>
      </div>
    </div>
  </div>

  <!-- Log -->
  <div id="modal-log" class="modal" role="dialog" aria-modal="true" aria-labelledby="logTitle">
    <div class="sheet">
      <header>
        <h3 id="logTitle">Olay Günlüğü</h3>
        <button class="btn btn--ghost" data-close="modal-log">Kapat</button>
      </header>
      <div id="log-list" class="list"></div>
    </div>
  </div>

  <!-- Settings -->
  <div id="modal-settings" class="modal" role="dialog" aria-modal="true" aria-labelledby="setTitle">
    <div class="sheet">
      <header>
        <h3 id="setTitle">Ayarlar</h3>
        <button class="btn btn--ghost" data-close="modal-settings">Kapat</button>
      </header>
      <div class="section row">
        <div class="field">
          <label for="opt-tooltips">Ülke Kartları</label>
          <select id="opt-tooltips">
            <option value="hover" selected>Üzerine gelince</option>
            <option value="locked">Sabit açık</option>
            <option value="hidden">Kapalı</option>
          </select>
        </div>
        <div class="field">
          <label for="opt-animations">Animasyonlar</label>
          <select id="opt-animations">
            <option value="on" selected>Açık</option>
            <option value="off">Kapalı</option>
          </select>
        </div>
      </div>
      <div class="section">
        <button id="btn-reset" class="btn btn--danger">Oyunu Sıfırla</button>
      </div>
    </div>
  </div>

  <!-- Tooltip + Toasts -->
  <div id="tooltip"></div>
  <div id="toasts" aria-live="polite"></div>

  <!-- Script (module) -->
  <script type="module" src="./gameLogic.js"></script>
</body>
</html>
